#pragma once;
#include "stdafx.h"
#include "DebugLog.h"
#include "Command.h"
#include "CommonDefine.h"
#include "dataexp.h"
#include "Util.h"
#include "sqlite3.h"

#ifndef theDB_Data
#define theDB_Data CFileLog::GetInstance(FILTER_DB_SQL_LOG)
#endif

namespace Data
{
	//////////////////////////////////////////////////////////////////////////
	/*
	@brief      数据库操作命令

	*/
	//////////////////////////////////////////////////////////////////////////
	class TVMDB_API CDataCommand:public CCommand
	{
	public:

		//////////////////////////////////////////////////////////////////////////
		/*
		@brief    构造函数

		@param

		@retval     

		@exception  
		*/
		//////////////////////////////////////////////////////////////////////////
		CDataCommand();

		//////////////////////////////////////////////////////////////////////////
		/*
		@brief   析构函数   

		@param

		@retval     

		@exception  
		*/
		//////////////////////////////////////////////////////////////////////////
		virtual ~CDataCommand();

		//////////////////////////////////////////////////////////////////////////
		/*
		@brief   取得错误信息。   

		@param

		@retval     

		@exception  
		*/
		//////////////////////////////////////////////////////////////////////////
		CString GetError();
	
	protected:

		//////////////////////////////////////////////////////////////////////////
		/*
		@brief   设置错误信息。
		@param

		@retval     

		@exception  
		*/
		//////////////////////////////////////////////////////////////////////////
		long SetErrorMessage(const char* pError);

		//////////////////////////////////////////////////////////////////////////
		/*
		@brief   数据库连接对象。   
		*/
		//////////////////////////////////////////////////////////////////////////
		static sqlite3* m_pConnection;
		
		//////////////////////////////////////////////////////////////////////////
		/*
		@brief   备份数据库连接对象。   
		*/
		//////////////////////////////////////////////////////////////////////////
		static sqlite3* m_pBackupConnection;
		

	private:

		//////////////////////////////////////////////////////////////////////////
		/*
		@brief   错误信息。   
		*/
		//////////////////////////////////////////////////////////////////////////
		CString m_Error;
	};
};
